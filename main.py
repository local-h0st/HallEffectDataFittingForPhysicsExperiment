import matplotlib.pyplot as plt
import matplotlib as mpl
import numpy as np


def drawB(x_in, y_in, name, xlab, ylab):
    plt.figure(name)
    plt.xlabel(xlab)
    plt.ylabel(ylab)
    plt.plot(x_in, y_in, 'ro')


def printKH_and_drawKH(x_in, y_in, name, xlab, ylab):
    z1 = np.polyfit(x_in, y_in, 1)
    print("[", name, "] KH : ", z1[0])
    p1 = np.poly1d(z1)
    y_pre = p1(x_in)
    plt.figure(name)
    plt.xlabel(xlab)
    plt.ylabel(ylab)
    plt.plot(x_in, y_in, '.')
    plt.plot(x_in, y_pre)
    plt.show()


x = (
    -190, -180, -170, -160, -150, -140, -130, -120, -110, -100, -90, -80, -70, -60, -50, -40, -30, -20, -10, 0, 10, 20,
    30,
    40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190)
UH2_2R = (
    -0.6, -0.69, -0.78, -0.9, -1.03, -1.11, -1.24, -1.35, -1.44, -1.51, -1.52, -1.50, -1.44, -1.36, -1.27, -1.19, -1.10,
    -1.04, -1.00, -0.98, -0.98, -1.00, -1.05, -1.11, -1.19, -1.28, -1.37, -1.45, -1.51, -1.53, -1.51, -1.45, -1.36,
    -1.24,
    -1.11, -0.98, -0.86, -0.75, -0.65)
UH2_R = (
    -0.34, -0.39, -0.44, -0.50, -0.58, -0.66, -0.77, -0.88, -1.01, -1.16, -1.30, -1.46, -1.60, -1.73, -1.84, -1.91,
    -1.96,
    -1.98, -1.99, -1.99, -1.99, -1.99, -1.98, -1.96, -1.91, -1.84, -1.73, -1.60, -1.45, -1.30, -1.14, -1.01, -0.87,
    -0.75,
    -0.66, -0.57, -0.49, -0.44, -0.38)
UH2_R2 = (
    -0.29, -0.33, -0.37, -0.42, -0.48, -0.55, -0.64, -0.74, -0.85, -0.99, -1.14, -1.31, -1.49, -1.69, -1.89, -2.08,
    -2.25,
    -2.39, -2.49, -2.53, -2.53, -2.47, -2.37, -2.22, -2.05, -1.85, -1.65, -1.45, -1.27, -1.10, -0.96, -0.83, -0.72,
    -0.62,
    -0.54, -0.47, -0.41, -0.36, -0.32)
UH1_R2 = (
    -0.16, -0.18, -0.20, -0.22, -0.24, -0.28, -0.31, -0.34, -0.40, -0.46, -0.55, -0.62, -0.72, -0.83, -0.95, -1.06,
    -1.17,
    -1.27, -1.34, -1.39, -1.38, -1.34, -1.26, -1.15, -1.04, -0.92, -0.82, -0.72, -0.62, -0.53, -0.46, -0.41, -0.34,
    -0.29,
    -0.26, -0.22, -0.20, -0.18, -0.16)

drawB(x, UH2_2R, "2 Coils 2R", "X(mm)", "UH")
drawB(x, UH2_R, "2 Coils R", "X(mm)", "UH")
drawB(x, UH2_R2, "2 Coils R/2", "X(mm)", "UH")
drawB(x, UH1_R2, "1 Coils R/2", "X(mm)", "UH")

# I-M fixed 0.7A
U11 = (-3.68, -4.44, -5.13, -5.88, -6.60, -7.37)
U12 = (3.64, 4.40, 5.09, 5.84, 6.56, 7.33)
U13 = (-.68, -4.44, -5.14, -5.88, -6.60, -7.37)
U14 = (3.64, 4.40, 5.10, 5.84, 6.56, 7.33)
UH1 = []
IS = (1.0, 1.2, 1.4, 1.6, 1.8, 2.0)
size = len(U11)
for i in range(size):
    UH1.append((U11[i] - U12[i] + U13[i] - U14[i]) / 4)

printKH_and_drawKH(IS, UH1, "IM fixed 0.7A", "IS(mA)", "UH(mV)")

# I-S fixed 2mA
U21 = (-2.15, -3.17, -4.23, -5.28, -6.32, -7.39)
U22 = (2.12, 3.13, 4.18, 5.24, 6.28, 7.35)
U23 = (-2.11, -3.17, -4.23, -5.29, -6.33, -7.39)
U24 = (2.08, 3.14, 4.19, 5.25, 6.29, 7.35)
UH2 = []
IM = (0.2, 0.3, 0.4, 0.5, 0.6, 0.7)
size = len(U21)
for i in range(size):
    UH2.append((U21[i] - U22[i] + U23[i] - U24[i]) / 4)

printKH_and_drawKH(IM, UH2, "IS fixed 2mA", "IM(A)", "UH(mV)")
